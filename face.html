<!DOCTYPE html>
<html>
  <head>
    <title>Chernoff Face</title>
    <script src="https://d3js.org/d3.v4.min.js"></script>
  </head>
  <body>
    <svg width="600" height="600"></svg>
    <script>
      var svg = d3.select("svg");

      var faceData = {
        hair: 2,
        eyebrow: 3,
        mouth: 3,
        face: 1,
      };

      var centroid = [100, 100];

      var face = svg.append("g").attr("transform", "translate(300,300)");

      var faceColor;
      switch (faceData.face) {
        case 1:
          faceColor = "#23c552";
          break;
        case 2:
          faceColor = "white";
          break;
        case 3:
          faceColor = "#f84f31";
          break;
      }

      // 确定眉毛的起始位置和结束位置
      var leftStart = [centroid[0] - 30, centroid[1] - 50];
      var leftControl = [centroid[0] - 20, centroid[1] - 60];
      var leftEnd = [centroid[0] - 10, centroid[1] - 50];
      var leftEnd2 = [centroid[0] - 20, centroid[1] - 40];
      var rightStart = [centroid[0] + 10, centroid[1] - 50];
      var rightControl = [centroid[0] + 20, centroid[1] - 60];
      var rightEnd = [centroid[0] + 30, centroid[1] - 50];
      var rightEnd2 = [centroid[0] + 30, centroid[1] - 70];
      var leftEyebrowPath;
      var rightEyebrowPath;
      switch (faceData.eyebrow) {
        case 1:
          // 向上弯曲的弧线
          leftEyebrowPath = `M${leftStart[0]},${leftStart[1]} Q${leftControl[0]},${leftControl[1]} ${leftEnd[0]},${leftEnd[1]}`;
          rightEyebrowPath = `M${rightStart[0]},${rightStart[1]} Q${rightControl[0]},${rightControl[1]} ${rightEnd[0]},${rightEnd[1]}`;
          break;
        case 2:
          // 平直的眉毛
          leftEyebrowPath = `M${leftStart[0]},${leftStart[1]} L${leftEnd[0]},${leftEnd[1]}`;
          rightEyebrowPath = `M${rightStart[0]},${rightStart[1]} L${rightEnd[0]},${rightEnd[1]}`;
          break;
        case 3:
          // 倒八字眉毛
          leftEyebrowPath = `M${leftStart[0]},${leftStart[1]} L${leftEnd2[0]},${leftEnd2[1]}`;
          rightEyebrowPath = `M${rightStart[0]},${rightStart[1]} L${rightEnd2[0]},${rightEnd2[1]}`;
          break;
      }
      var mouthPath = `M${centroid[0] - 30},${centroid[1] + 30} Q${
        centroid[0]
      },${centroid[1] + 30 - 20 * (faceData.mouth - 2)} ${centroid[0] + 30},${
        centroid[1] + 30
      }`;
      // Face
      face
        .append("ellipse")
        .attr("cx", centroid[0])
        .attr("cy", centroid[1])
        .attr("rx", 100)
        .attr("ry", 100)
        .attr("fill", faceColor)
        .attr("stroke", "black");

      // Hair
      switch (faceData.hair) {
        case 1:
          face
            .append("ellipse")
            .attr("cx", centroid[0])
            .attr("cy", centroid[1] - 80) // 调整发型的位置
            .attr("rx", 60) // 调整发型的大小
            .attr("ry", 20) // 调整发型的大小
            .attr("fill", "black");
          break;
        case 2:
          face
            .append("rect")
            .attr("x", centroid[0]-80) // 调整矩形的位置
            .attr("y", centroid[1] - 120) // 调整矩形的位置
            .attr("width", 160) // 调整矩形的宽度
            .attr("height", 60) // 调整矩形的高度
            .attr("fill", "black");
          break;
        case 3:
          face
            .append(faceData.hair === 1 ? "ellipse" : "rect")
            .attr("cx", centroid[0])
            .attr("cy", centroid[1] - 80) // 调整发型的位置
            .attr("rx", faceData.hair === 1 ? 60 : 100) // 调整发型的大小
            .attr("ry", faceData.hair === 1 ? 20 : 100) // 调整发型的大小
            .attr("fill", "black");
          break;
      }

      // Eyes
      face
        .append("circle")
        .attr("cx", centroid[0] - 20)
        .attr("cy", centroid[1] - 20)
        .attr("r", 10)
        .attr("fill", "black");
      face
        .append("circle")
        .attr("cx", centroid[0] + 20)
        .attr("cy", centroid[1] - 20)
        .attr("r", 10)
        .attr("fill", "black");
      //eyebrow
      face
        .append("path")
        .attr("d", leftEyebrowPath)
        .attr("stroke", "black")
        .attr("stroke-width", 4)
        .attr("fill", "none");
      face
        .append("path")
        .attr("d", rightEyebrowPath)
        .attr("stroke", "black")
        .attr("stroke-width", 3)
        .attr("fill", "none");

      // Mouth
      face
        .append("path")
        .attr("d", mouthPath)
        .attr("stroke", "black")
        .attr("stroke-width", 2)
        .attr("fill", "none");
    </script>
  </body>
</html>
